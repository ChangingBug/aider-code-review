# Aider Code Review ä¸­é—´ä»¶

åŸºäº [Aider](https://github.com/paul-gauthier/aider) çš„è‡ªåŠ¨åŒ–ä»£ç å®¡æŸ¥ä¸­é—´ä»¶æœåŠ¡ï¼Œæ”¯æŒå†…ç½‘ vLLM éƒ¨ç½²ã€‚

## âœ¨ ç‰¹æ€§

- ğŸ”— **Webhooké›†æˆ**ï¼šæ”¯æŒ GitLabã€Giteaã€GitHub Enterprise
- ğŸ¤– **åŒç­–ç•¥å®¡æŸ¥**ï¼š
  - **Commitå®¡æŸ¥**ï¼šæ¯æ¬¡æäº¤åå¿«é€Ÿå¢é‡å®¡æŸ¥
  - **MRå®¡æŸ¥**ï¼šåˆå¹¶è¯·æ±‚æ—¶æ·±åº¦å…¨é¢å®¡æŸ¥
- ğŸ”’ **å†…ç½‘å‹å¥½**ï¼šé€‚é… vLLM å†…ç½‘éƒ¨ç½²åœºæ™¯
- ğŸ“¦ **ä»£ç ä¸é•œåƒåˆ†ç¦»**ï¼šä¾¿äºå†…ç½‘æ›´æ–°å’Œç»´æŠ¤
- ğŸ“Š **Webä»ªè¡¨ç›˜**ï¼šå¯è§†åŒ–ç»Ÿè®¡åˆ†æ
- âš™ï¸ **åœ¨çº¿é…ç½®**ï¼šé€šè¿‡Webé¡µé¢é…ç½®ï¼Œå®æ—¶ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯

## ğŸ–¥ï¸ Web ä»ªè¡¨ç›˜

è®¿é—® `http://<server>:5000/` æŸ¥çœ‹ä»ªè¡¨ç›˜ï¼ŒåŒ…å«ï¼š

- **æ¦‚è§ˆç»Ÿè®¡**ï¼šå®¡æŸ¥æ€»æ•°ã€é—®é¢˜åˆ†å¸ƒã€è´¨é‡è¯„åˆ†
- **å®¡æŸ¥è®°å½•**ï¼šå†å²å®¡æŸ¥åˆ—è¡¨å’Œè¯¦æƒ…
- **æäº¤äººç»Ÿè®¡**ï¼šæŒ‰å¼€å‘è€…ç»Ÿè®¡ä»£ç è´¨é‡
- **é¡¹ç›®ç»Ÿè®¡**ï¼šæŒ‰é¡¹ç›®ç»Ÿè®¡å®¡æŸ¥æƒ…å†µ
- **âš™ï¸ ç³»ç»Ÿè®¾ç½®**ï¼šåœ¨çº¿é…ç½®Git/vLLM/Aiderå‚æ•°

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Webhook      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Git Platformâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  Review Server  â”‚ â”€â”€â–º â”‚  vLLM    â”‚
â”‚ (GitLabç­‰)  â”‚                  â”‚   (FastAPI)     â”‚     â”‚  API     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                    â”‚                    â”‚
                     â–¼                    â–¼                    â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  SQLite  â”‚         â”‚   Web    â”‚         â”‚  Git     â”‚
              â”‚  (ç»Ÿè®¡)  â”‚         â”‚ Dashboardâ”‚         â”‚ Comment  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

### 1. å¤–ç½‘æ„å»ºé•œåƒ

```bash
cd ai_code_review
./scripts/build.sh
# è¾“å‡º: aider-reviewer_latest.tar.gz
```

### 2. å†…ç½‘éƒ¨ç½²

**æ–¹å¼ä¸€ï¼šä½¿ç”¨ docker run è„šæœ¬ï¼ˆæ¨èï¼‰**

```bash
# å¯åŠ¨æœåŠ¡
./scripts/run.sh

# åœæ­¢æœåŠ¡
./scripts/stop.sh
```

**æ–¹å¼äºŒï¼šä½¿ç”¨ docker-compose**

```bash
docker-compose up -d
```

### 3. é…ç½®ç³»ç»Ÿå‚æ•°

å¯åŠ¨åè®¿é—® `http://<server_ip>:5000/`ï¼Œç‚¹å‡» **âš™ï¸ ç³»ç»Ÿè®¾ç½®**ï¼š

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| **Gitå¹³å°ç±»å‹** | gitlab / gitea / github |
| **æœåŠ¡å™¨åœ°å€** | å¦‚ `http://code.kf.zjnx.net` |
| **HTTPç”¨æˆ·å/å¯†ç ** | ç”¨äºå…‹éš†ç§æœ‰ä»“åº“ |
| **APIåœ°å€** | å¦‚ `http://code.kf.zjnx.net/api/v4` |
| **API Token** | ç”¨äºå›å†™è¯„è®º |
| **å¯ç”¨è¯„è®ºå›å†™** | å¼€å…³æ§åˆ¶æ˜¯å¦å‘å¸ƒå®¡æŸ¥è¯„è®º |
| **vLLM APIåœ°å€** | å¦‚ `http://192.168.1.100:8000/v1` |
| **æ¨¡å‹åç§°** | å¦‚ `openai/qwen-2.5-coder-32b` |

> ğŸ’¡ æ‰€æœ‰é…ç½®ä¿®æ”¹å**ç«‹å³ç”Ÿæ•ˆ**ï¼Œæ— éœ€é‡å¯å®¹å™¨

### 4. é…ç½® Webhook

åœ¨ Git å¹³å°é…ç½® Webhookï¼š
- **URL**: `http://<server_ip>:5000/webhook`
- **è§¦å‘äº‹ä»¶**: Push events, Merge request events

## ç›®å½•ç»“æ„

```
ai_code_review/
â”œâ”€â”€ review_server.py      # FastAPIä¸»æœåŠ¡ + API
â”œâ”€â”€ config.py             # é…ç½®ç®¡ç†ï¼ˆç¯å¢ƒå˜é‡é»˜è®¤å€¼ï¼‰
â”œâ”€â”€ settings.py           # åŠ¨æ€é…ç½®ç®¡ç†ï¼ˆæ•°æ®åº“å­˜å‚¨ï¼‰
â”œâ”€â”€ utils.py              # å·¥å…·å‡½æ•°
â”œâ”€â”€ models.py             # æ•°æ®åº“æ¨¡å‹
â”œâ”€â”€ database.py           # æ•°æ®åº“ç®¡ç†
â”œâ”€â”€ statistics.py         # ç»Ÿè®¡æœåŠ¡
â”œâ”€â”€ static/               # Webä»ªè¡¨ç›˜
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ style.css
â”‚   â””â”€â”€ app.js
â”œâ”€â”€ data/                 # æ•°æ®åº“æ–‡ä»¶(è‡ªåŠ¨åˆ›å»º)
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ build.sh          # å¤–ç½‘æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ deploy.sh         # å†…ç½‘éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ run.sh            # docker run å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ stop.sh           # åœæ­¢æœåŠ¡è„šæœ¬
â””â”€â”€ README.md
```

## API æ¥å£

### ç»Ÿè®¡API

| ç«¯ç‚¹ | è¯´æ˜ |
|------|------|
| `GET /api/stats/overview` | æ¦‚è§ˆç»Ÿè®¡ |
| `GET /api/stats/daily-trend` | æ¯æ—¥è¶‹åŠ¿ |
| `GET /api/stats/authors` | æäº¤äººç»Ÿè®¡ |
| `GET /api/stats/projects` | é¡¹ç›®ç»Ÿè®¡ |
| `GET /api/stats/reviews` | å®¡æŸ¥è®°å½•åˆ—è¡¨ |
| `GET /api/stats/review/{task_id}` | å®¡æŸ¥è¯¦æƒ… |

### è®¾ç½®API

| ç«¯ç‚¹ | è¯´æ˜ |
|------|------|
| `GET /api/settings` | è·å–æ‰€æœ‰é…ç½® |
| `POST /api/settings` | æ‰¹é‡æ›´æ–°é…ç½® |

### æ“ä½œAPI

| ç«¯ç‚¹ | è¯´æ˜ |
|------|------|
| `POST /webhook` | Git Webhook |
| `POST /review` | æ‰‹åŠ¨è§¦å‘å®¡æŸ¥ |
| `GET /health` | å¥åº·æ£€æŸ¥ |

## License

MIT

